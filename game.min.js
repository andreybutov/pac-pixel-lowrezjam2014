window.onload=function(){function N(){n=document.getElementById("game");i=n.getContext("2d");r=document.getElementById("zoomed");s=r.getContext("2d");s.imageSmoothingEnabled=false;s.mozImageSmoothingEnabled=false;s.webkitImageSmoothingEnabled=false;i.fillStyle="black";C();k();L(3);_();setInterval(O,1e3/t)}function C(){}function k(){for(var t=0;t<e;++t){for(var n=m;n<e;++n){if(j(t,n)==o.empty){if(Math.random()<.1){F(t,n,o.food)}}}}}function L(e){while(e){var t=V(T);x.push({x:t.x,y:t.y,direction:t.direction});--e}}function A(){var t=0;var n=[];for(var r=0;r<e;++r){for(var i=m;i<e;++i){switch(j(r,i)){case o.food:t++;break;case o.empty:n.push({x:r,y:i});break}}}if(t<10){var s=X(1,5);while(s>0){var u=V(n);F(u.x,u.y,o.food);s--}}}function O(){i.fillRect(0,0,e,e);J();for(var t=0;t<e;++t){W(63,51,106,t,m-1)}for(var t=0;t<e;++t){for(var r=m;r<e;++r){var u=0;var a=0;var f=0;var l=255;switch(j(t,r)){case o.empty:break;case o.wall:u=94;a=74;f=162;break;case o.food:u=255;a=255;f=255;break}W(u,a,f,t,r)}}if(y){for(var t=0;t<e;++t){for(var r=0;r<E.length;++r){var p=E[r][t];W(p.r,p.g,p.b,t,r+m)}}$()}else{D();P();if(!y){H();W(255,255,0,c,h);B();A()}}var d=M(n,10);s.drawImage(d,0,0)}function M(e,t){var n=e.width*t;var r=e.height*t;var i=document.createElement("canvas");i.width=e.width;i.height=e.height;var s=i.getContext("2d");s.drawImage(e,0,0);var o=s.getImageData(0,0,e.width,e.height);var u=document.createElement("canvas");u.width=n;u.height=r;var a=u.getContext("2d");var f=a.getImageData(0,0,n,r);for(var l=0;l<r;l++){for(var c=0;c<n;c++){var h=(Math.floor(l/t)*e.width+Math.floor(c/t))*4;var p=(l*n+c)*4;f.data[p]=o.data[h];f.data[p+1]=o.data[h+1];f.data[p+2]=o.data[h+2];f.data[p+3]=o.data[h+3]}}a.putImageData(f,0,0);return u}function _(){document.onkeydown=function(e){var t=window.event?window.event.keyCode:e.which;switch(t){case a.left:d=u.left;return false;case a.up:d=u.up;return false;case a.right:d=u.right;return false;case a.down:d=u.down;return false;default:return true}}}function D(){var e=c;var t=h;if(d!=p){switch(d){case u.up:t=z(h-1);break;case u.right:e=U(c+1);break;case u.down:t=z(h+1);break;case u.left:e=U(c-1);break}if(I(e,t)){p=d}}e=c;t=h;switch(p){case u.up:t=z(h-1);break;case u.right:e=U(c+1);break;case u.down:t=z(h+1);break;case u.left:e=U(c-1);break}if(I(e,t)){f=c;l=h;c=e;h=t}}function P(){for(var e=0;e<x.length;++e){var t=q(x[e].x,x[e].y,R(x[e].direction));x[e].direction=V(t);var n=x[e].x;var r=x[e].y;switch(x[e].direction){case u.up:x[e].y=z(x[e].y-1);break;case u.right:x[e].x=U(x[e].x+1);break;case u.down:x[e].y=z(x[e].y+1);break;case u.left:x[e].x=U(x[e].x-1);break}if(x[e].x==c&&x[e].y==h){y=true}if(c==n&&h==r&&f==x[e].x&&l==x[e].y){y=true}}}function H(){for(var e=0;e<x.length;++e){W(175,78,78,x[e].x,x[e].y)}}function B(){if(j(c,h)==o.food){v++;if(v%25==0&&v!=g){L(1);g=v}F(c,h,o.empty)}}function j(e,t){return S[t][e]}function F(e,t,n){S[t][e]=n}function I(e,t){switch(j(e,t)){case o.empty:case o.food:return true;default:return false}}function q(e,t,n){var r=I(e,z(t-1));var i=I(U(e+1),t);var s=I(e,z(t+1));var o=I(U(e-1),t);var a=[];if(r&&n!=u.up)a.push(u.up);if(i&&n!=u.right)a.push(u.right);if(s&&n!=u.down)a.push(u.down);if(o&&n!=u.left)a.push(u.left);return a}function R(e){switch(e){case u.up:return u.down;case u.right:return u.left;case u.down:return u.up;case u.left:return u.right}}function U(t){if(t>e-1)return 0;if(t<0)return e-1;return t}function z(t){if(t<m)return e-1;if(t>e-1)return m;return t}function W(e,t,n,r,s){var o=i.createImageData(1,1);var u=o.data;u[0]=e;u[1]=t;u[2]=n;u[3]=255;i.putImageData(o,r,s)}function X(e,t){return Math.floor(Math.random()*(t-e+1))+e}function V(e){return e[Math.floor(Math.random()*e.length)]}function $(){if(b){return}E.push([]);for(var t=0;t<e;++t){E[w][t]={r:X(100,200),g:X(100,200),b:X(100,200)}}w++;if(w+m>e-1){b=true}}function J(){var e=0;var t=0;var n=v.toString();var r=n.length;for(var i=0;i<r;++i){switch(n.charAt(i)){case"0":e+=K(e,t);break;case"1":e+=Q(e,t);break;case"2":e+=G(e,t);break;case"3":e+=Y(e,t);break;case"4":e+=Z(e,t);break;case"5":e+=et(e,t);break;case"6":e+=tt(e,t);break;case"7":e+=nt(e,t);break;case"8":e+=rt(e,t);break;case"9":e+=it(e,t);break}e++}}function K(e,t){W(255,255,255,e,t);W(255,255,255,e+1,t);W(255,255,255,e+2,t);W(255,255,255,e+3,t);W(255,255,255,e,t+1);W(255,255,255,e+1,t+1);W(255,255,255,e+3,t+1);W(255,255,255,e,t+2);W(255,255,255,e+1,t+2);W(255,255,255,e+3,t+2);W(255,255,255,e,t+3);W(255,255,255,e+1,t+3);W(255,255,255,e+3,t+3);W(255,255,255,e,t+4);W(255,255,255,e+1,t+4);W(255,255,255,e+2,t+4);W(255,255,255,e+3,t+4);return 4}function Q(e,t){W(255,255,255,e,t);W(255,255,255,e,t+1);W(255,255,255,e,t+2);W(255,255,255,e,t+3);W(255,255,255,e,t+4);W(255,255,255,e+1,t);W(255,255,255,e+1,t+1);W(255,255,255,e+1,t+2);W(255,255,255,e+1,t+3);W(255,255,255,e+1,t+4);return 2}function G(e,t){W(255,255,255,e,t);W(255,255,255,e+1,t);W(255,255,255,e+2,t);W(255,255,255,e+3,t);W(255,255,255,e+2,t+1);W(255,255,255,e+3,t+1);W(255,255,255,e,t+2);W(255,255,255,e+1,t+2);W(255,255,255,e+2,t+2);W(255,255,255,e+3,t+2);W(255,255,255,e,t+3);W(255,255,255,e+1,t+3);W(255,255,255,e,t+4);W(255,255,255,e+1,t+4);W(255,255,255,e+2,t+4);W(255,255,255,e+3,t+4);return 4}function Y(e,t){W(255,255,255,e,t);W(255,255,255,e+1,t);W(255,255,255,e+2,t);W(255,255,255,e+3,t);W(255,255,255,e+2,t+1);W(255,255,255,e+3,t+1);W(255,255,255,e,t+2);W(255,255,255,e+1,t+2);W(255,255,255,e+2,t+2);W(255,255,255,e+3,t+2);W(255,255,255,e+2,t+3);W(255,255,255,e+3,t+3);W(255,255,255,e,t+4);W(255,255,255,e+1,t+4);W(255,255,255,e+2,t+4);W(255,255,255,e+3,t+4);return 4}function Z(e,t){W(255,255,255,e,t);W(255,255,255,e+2,t);W(255,255,255,e+3,t);W(255,255,255,e,t+1);W(255,255,255,e+2,t+1);W(255,255,255,e+3,t+1);W(255,255,255,e,t+2);W(255,255,255,e+1,t+2);W(255,255,255,e+2,t+2);W(255,255,255,e+3,t+2);W(255,255,255,e+2,t+3);W(255,255,255,e+3,t+3);W(255,255,255,e+2,t+4);W(255,255,255,e+3,t+4);return 4}function et(e,t){W(255,255,255,e,t);W(255,255,255,e+1,t);W(255,255,255,e+2,t);W(255,255,255,e+3,t);W(255,255,255,e,t+1);W(255,255,255,e,t+2);W(255,255,255,e+1,t+2);W(255,255,255,e+2,t+2);W(255,255,255,e+3,t+2);W(255,255,255,e+2,t+3);W(255,255,255,e+3,t+3);W(255,255,255,e,t+4);W(255,255,255,e+1,t+4);W(255,255,255,e+2,t+4);W(255,255,255,e+3,t+4);return 4}function tt(e,t){W(255,255,255,e,t);W(255,255,255,e+1,t);W(255,255,255,e+2,t);W(255,255,255,e+3,t);W(255,255,255,e,t+1);W(255,255,255,e,t+2);W(255,255,255,e+1,t+2);W(255,255,255,e+2,t+2);W(255,255,255,e+3,t+2);W(255,255,255,e,t+3);W(255,255,255,e+3,t+3);W(255,255,255,e,t+4);W(255,255,255,e+1,t+4);W(255,255,255,e+2,t+4);W(255,255,255,e+3,t+4);return 4}function nt(e,t){W(255,255,255,e,t);W(255,255,255,e+1,t);W(255,255,255,e+2,t);W(255,255,255,e+3,t);W(255,255,255,e,t+1);W(255,255,255,e+1,t+1);W(255,255,255,e+2,t+1);W(255,255,255,e+3,t+1);W(255,255,255,e+3,t+2);W(255,255,255,e+3,t+3);W(255,255,255,e+3,t+4);return 4}function rt(e,t){W(255,255,255,e,t);W(255,255,255,e+1,t);W(255,255,255,e+2,t);W(255,255,255,e+3,t);W(255,255,255,e,t+1);W(255,255,255,e+1,t+1);W(255,255,255,e+3,t+1);W(255,255,255,e,t+2);W(255,255,255,e+1,t+2);W(255,255,255,e+2,t+2);W(255,255,255,e+3,t+2);W(255,255,255,e,t+3);W(255,255,255,e+1,t+3);W(255,255,255,e+3,t+3);W(255,255,255,e,t+4);W(255,255,255,e+1,t+4);W(255,255,255,e+2,t+4);W(255,255,255,e+3,t+4);return 4}function it(e,t){W(255,255,255,e,t);W(255,255,255,e+1,t);W(255,255,255,e+2,t);W(255,255,255,e+3,t);W(255,255,255,e,t+1);W(255,255,255,e+3,t+1);W(255,255,255,e,t+2);W(255,255,255,e+1,t+2);W(255,255,255,e+2,t+2);W(255,255,255,e+3,t+2);W(255,255,255,e+2,t+3);W(255,255,255,e+3,t+3);W(255,255,255,e+2,t+4);W(255,255,255,e+3,t+4);return 4}var e=32;var t=5;var n;var r;var i;var s;var o={empty:0,wall:1,food:2};var u={up:0,right:1,down:2,left:3};var a={up:38,right:39,down:40,left:37};var f;var l;var c=11;var h=17;var p=u.right;var d=p;var v=0;var m=6;var g=0;var y=false;var b=false;var w=0;var E=[];var S=[[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,0,1,1,1,1,1,0,1,1,1,1,1,1,1,1,0,1,1,1,1,1,0,1,1,1,1,1],[1,1,1,1,1,0,1,1,1,1,1,0,1,1,1,1,1,1,1,1,0,1,1,1,1,1,0,1,1,1,1,1],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[1,1,0,1,1,0,1,1,1,1,1,0,1,1,1,1,1,1,1,1,0,1,1,1,1,1,0,1,1,0,1,1],[1,1,0,1,1,0,1,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,1,0,1,1,0,1,1],[1,1,0,1,1,0,1,0,1,1,1,1,1,1,0,1,1,0,1,1,1,1,1,1,0,1,0,1,1,0,1,1],[1,1,0,1,1,0,1,0,1,1,1,1,1,1,0,1,1,0,1,1,1,1,1,1,0,1,0,1,1,0,1,1],[1,1,0,1,1,0,1,0,1,1,1,1,1,1,0,1,1,0,1,1,1,1,1,1,0,1,0,1,1,0,1,1],[1,1,0,0,0,0,0,0,1,1,1,0,0,0,0,0,0,0,0,0,0,1,1,1,0,0,0,0,0,0,1,1],[1,1,0,1,1,0,1,0,1,1,1,0,1,1,0,1,1,0,1,1,0,1,1,1,0,1,0,1,1,0,1,1],[1,1,0,1,1,0,1,0,1,1,1,0,1,1,0,1,1,0,1,1,0,1,1,1,0,1,0,1,1,0,1,1],[1,1,0,1,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,1,0,1,1],[1,1,0,1,1,0,1,1,1,1,1,0,1,1,0,1,1,0,1,1,0,1,1,1,1,1,0,1,1,0,1,1],[1,1,0,1,1,0,1,1,1,1,1,0,1,1,0,1,1,0,1,1,0,1,1,1,1,1,0,1,1,0,1,1],[1,1,0,1,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,1,0,1,1],[1,1,0,1,1,0,1,0,1,1,1,0,1,1,0,1,1,0,1,1,0,1,1,1,0,1,0,1,1,0,1,1],[1,1,0,1,1,0,1,0,1,1,1,0,1,1,0,1,1,0,1,1,0,1,1,1,0,1,0,1,1,0,1,1],[1,1,0,0,0,0,0,0,1,1,1,0,0,0,0,0,0,0,0,0,0,1,1,1,0,0,0,0,0,0,1,1],[1,1,0,1,1,0,1,0,1,1,1,1,1,1,0,1,1,0,1,1,1,1,1,1,0,1,0,1,1,0,1,1],[1,1,0,1,1,0,1,0,1,1,1,1,1,1,0,1,1,0,1,1,1,1,1,1,0,1,0,1,1,0,1,1],[1,1,0,1,1,0,1,0,1,1,1,1,1,1,0,1,1,0,1,1,1,1,1,1,0,1,0,1,1,0,1,1],[1,1,0,1,1,0,1,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,1,0,1,1,0,1,1],[1,1,0,1,1,0,1,1,1,1,1,0,1,1,1,1,1,1,1,1,0,1,1,1,1,1,0,1,1,0,1,1],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[1,1,1,1,1,0,1,1,1,1,1,0,1,1,1,1,1,1,1,1,0,1,1,1,1,1,0,1,1,1,1,1],[1,1,1,1,1,0,1,1,1,1,1,0,1,1,1,1,1,1,1,1,0,1,1,1,1,1,0,1,1,1,1,1]];var x=[];var T=[{x:5,y:m,direction:u.down},{x:11,y:m,direction:u.down},{x:20,y:m,direction:u.down},{x:26,y:m,direction:u.down},{x:5,y:e-1,direction:u.up},{x:11,y:e-1,direction:u.up},{x:20,y:e-1,direction:u.up},{x:26,y:e-1,direction:u.up},{x:0,y:m+2,direction:u.right},{x:0,y:e-3,direction:u.right},{x:e-1,y:m+2,direction:u.left},{x:e-1,y:e-3,direction:u.left}];N()}